<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Jersey Sublimation Price (Daily) â€” Rotated (Sizes left) with Original Prices</title>

<style>
  :root{
    --primary:#4400ff;
    --bg:#f9f9fc;
    --border:#ddd;
    --accent:#ff6b6b;
    --text:#111827;
    --oversize-bg:#fff2f2;
    --oversize-text:#a80000;
  }
  body{
    font-family: "Segoe UI", Roboto, Arial, sans-serif;
    margin:20px;
    background:var(--bg);
    color:var(--text);
  }
  .branding{ color:var(--primary); font-weight:700; margin-bottom:8px; }
  h1{ margin:0 0 12px 0; color:var(--primary); font-size:1.2rem; }

  .controls{ margin:8px 0 14px 0; }
  .controls button{
    background:var(--primary); color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; margin-right:8px;
  }
  .controls button.secondary{ background:#fff; color:var(--primary); border:1px solid var(--border); }

  .sizing-wrapper{
    width:100%;
    border-radius:10px;
    background:#fff;
    border:1px solid var(--border);
    overflow:auto;
    max-height:700px;
  }

  table.sizing-table{
    border-collapse:collapse;
    width:max-content;
    min-width:1100px;
  }
  table.sizing-table th, table.sizing-table td{
    border:1px solid var(--border);
    padding:8px 10px;
    white-space:nowrap;
    text-align:center;
    font-size:0.95rem;
  }

  /* top sticky */
  th.product-top{
    position:sticky;
    top:0;
    background:#f0f0ff;
    z-index:40;
    font-weight:700;
    padding:10px 12px;
    vertical-align:bottom;
  }

  .product-title{ display:block; font-weight:700; font-size:0.95rem; }
  .product-price{ display:block; font-size:0.85rem; color:#334155; margin-top:6px; }

  /* left sticky */
  td.size-col, th.size-col{
    position:sticky;
    left:0;
    background:#e8f8ff;
    z-index:45;
    font-weight:700;
    text-align:left;
    padding-left:12px;
    min-width:120px;
  }

  /* corner */
  th.corner{
    position:sticky;
    top:0;
    left:0;
    z-index:50;
    background:#f0f0ff;
    text-align:left;
    padding-left:12px;
    min-width:120px;
  }

  /* oversized highlight */
  td.oversized{
    background:var(--oversize-bg);
    color:var(--oversize-text);
    font-weight:700;
  }

  /* Option A layout */
  .cell-wrap{
    display:flex;
    flex-direction:column;
    align-items:center;
  }

  .price-below{
    margin-top:4px;
    font-size:0.78rem;
    color:#555;
    font-weight:600;
  }

  input.qty{
    width:68px;
    padding:5px;
    border-radius:6px;
    border:1px solid #cfcfcf;
    text-align:center;
  }

  .totals-row th, .totals-row td{
    background:#fff7f7;
    font-weight:700;
  }

  .summary{
    display:flex;
    justify-content:center;   /* center the box */
    margin-top:12px;
}

.grand{
    width:80%;                /* wider summary box */
    max-width:900px;          /* optional limit */
    margin:auto;
    background:#fff;
    padding:20px;
    border-radius:10px;
    box-shadow:0 3px 10px rgba(10,10,20,0.05);
    border:1px solid var(--border);
}

  .grand h3{
    text-align:center;
}

  .grand p{ margin:6px 0; font-weight:600; }

  @media print{
    body *{ visibility:hidden; }
    .printable, .printable *{ visibility:visible; }
    .printable{ position:absolute; left:0; top:0; width:100% }
    .sizing-wrapper{ max-height:none; overflow:visible; }
  }
</style>

</head>
<body>

<div class="branding">Inspirazs Sdn. Bhd.</div>
<h1>Jersey Sublimation Price (Daily)</h1>

<div class="controls no-print">
  <button onclick="window.print()">Print</button>
  <button class="secondary" onclick="exportCSV()">Export CSV</button>
</div>

<div class="sizing-wrapper" id="grid-wrap">
  <table class="sizing-table" id="sizing-table">
    <thead id="thead"></thead>
    <tbody id="tbody"></tbody>
    <tfoot id="tfoot"></tfoot>
  </table>
</div>

<div class="summary printable">
  <div class="grand">
    <h3 style="margin:0 0 8px 0;">Order Summary</h3>
    <div id="print-summary"></div>
    <p>Total Original (RM): <span id="grand-normal">0.00</span></p>

<p>Arrival Postage (RM):
  <input type="number" id="arrival-postage" value="0" min="0" step="0.01"
         style="width:100px; padding:4px; margin-left:8px;">
</p>

<p>Send-out Postage (RM):
  <input type="number" id="send-postage" value="0" min="0" step="0.01"
         style="width:100px; padding:4px; margin-left:8px;">
</p>

<p><strong>Grand Total + Postage (RM):</strong>
  <span id="grand-total">0.00</span>
</p>

  </div>
</div>

<script>
/* Products */
const products = [
  { key: "S.SLEEVE - R", normal: 22.5 },
  { key: "S.SLEEVE - C", normal: 28.5 },
  { key: "L.SLEEVE - R", normal: 24.5 },
  { key: "L.SLEEVE - C", normal: 34.5 },
  { key: "MUSLIMAH - R", normal: 28.0 },
  { key: "MUSLIMAH - C", normal: 33.0 }
];

/* Sizes */
const sizes = ["XS","S","M","L","XL","2XL","3XL","4XL","5XL","6XL","7XL","8XL","9XL","10XL","11XL"];

/* Build table */
function buildTable(){
  const thead=document.getElementById("thead");
  const tbody=document.getElementById("tbody");
  const tfoot=document.getElementById("tfoot");

  thead.innerHTML="";
  tbody.innerHTML="";
  tfoot.innerHTML="";

  /* header */
  let head="<tr>";
  head+=`<th class="corner size-col">Size</th>`;
  products.forEach((p,i)=>{
    head+=`<th class="product-top"><span class="product-title">${i+1}. ${p.key}</span><span class="product-price">RM ${p.normal.toFixed(2)}</span></th>`;
  });
  head+="</tr>";
  thead.innerHTML=head;

  /* rows */
  sizes.forEach((sz,si)=>{
    let row=`<tr>`;
    row+=`<td class="size-col">${sz}</td>`;
    products.forEach((p,pi)=>{
      const isOversize = si >= 5;
      row+=`
      <td ${isOversize?'class="oversized"':""}>
        <div class="cell-wrap">
          <input class="qty" type="number" min="0" value="0"
            data-pidx="${pi}" data-sidx="${si}">
          <div class="price-below">RM ${p.normal.toFixed(2)}</div>
        </div>
      </td>`;
    });
    row+="</tr>";
    tbody.insertAdjacentHTML("beforeend", row);
  });

  /* foot totals */
  let foot1=`<tr class="totals-row"><th class="size-col">Total QTY</th>`;
  let foot2=`<tr class="totals-row"><th class="size-col">Total Original (RM)</th>`;
  products.forEach((p,pi)=>{
    foot1+=`<td class="col-total-qty" data-pidx="${pi}">0</td>`;
    foot2+=`<td class="col-total-orig" data-pidx="${pi}">0.00</td>`;
  });
  foot1+="</tr>";
  foot2+="</tr>";
  tfoot.innerHTML=foot1+foot2;
}

/* compute totals */
function updateTotals(){
  const totals=products.map(()=>({qty:0,orig:0}));
  let grandOrig=0;

  document.querySelectorAll("input.qty").forEach(inp=>{
    let qty=parseInt(inp.value)||0;
    if(qty<0) qty=0;
    const p=inp.dataset.pidx;
    if(qty>0){
      const price=products[p].normal;
      totals[p].qty+=qty;
      totals[p].orig+=qty*price;
      grandOrig+=qty*price;
    }
  });

  totals.forEach((t,i)=>{
    document.querySelector(`.col-total-qty[data-pidx="${i}"]`).textContent=t.qty;
    document.querySelector(`.col-total-orig[data-pidx="${i}"]`).textContent=t.orig.toFixed(2);
  });

  /* summary with size breakdown */
let s = "";

/* build product summary */
products.forEach((p, i) => {
    let sizeBreakdown = "";
    let totalQty = 0;
    let totalOrig = 0;

    sizes.forEach((sz, si) => {
        const qtyInput = document.querySelector(`input.qty[data-pidx="${i}"][data-sidx="${si}"]`);
        const qty = parseInt(qtyInput.value) || 0;

        if (qty > 0) {
            sizeBreakdown += `${sz}: ${qty}<br>`;
            totalQty += qty;
            totalOrig += qty * p.normal;
        }
    });

    if (totalQty > 0) {
        s += `
        <div style="margin-bottom:12px; padding:10px; border:1px solid var(--border); border-radius:6px; background:#fff;">
            <div style="font-weight:700; color:#333;">${i + 1}. ${p.key}</div>
            <div style="margin-left:12px; margin-top:4px; font-size:0.9rem; color:#444;">
                ${sizeBreakdown}
            </div>
            <div style="margin-top:6px; font-weight:700;">
                Total Qty: ${totalQty} &nbsp;&nbsp; | &nbsp;&nbsp;
                RM ${totalOrig.toFixed(2)}
            </div>
        </div>`;
    }
});

document.getElementById("print-summary").innerHTML = s;

  document.getElementById("grand-normal").textContent = grandOrig.toFixed(2);

/* postage */
const arrival = parseFloat(document.getElementById("arrival-postage").value) || 0;
const send = parseFloat(document.getElementById("send-postage").value) || 0;

const grandWithPostage = grandOrig + arrival + send;
document.getElementById("grand-total").textContent = grandWithPostage.toFixed(2);

}

/* CSV export */
function exportCSV(){
  updateTotals();
  const rows=[["Item","Qty","Original (RM)"]];
  products.forEach((p,i)=>{
    const qty=document.querySelector(`.col-total-qty[data-pidx="${i}"]`).textContent;
    const orig=document.querySelector(`.col-total-orig[data-pidx="${i}"]`).textContent;
    if(Number(qty)>0) rows.push([`${i+1}. ${p.key}`, qty, orig]);
  });
  if(rows.length===1){ alert("No quantities"); return; }
  const csv="data:text/csv;charset=utf-8,"+rows.map(r=>r.join(",")).join("\n");
  const a=document.createElement("a");
  a.href=csv;
  a.download="jersey_original_summary.csv";
  a.click();
}

/* init */
buildTable();
updateTotals();

/* live update */
document.getElementById("grid-wrap").addEventListener("input",e=>{
  document.getElementById("arrival-postage").addEventListener("input", updateTotals);
document.getElementById("send-postage").addEventListener("input", updateTotals);

  if(e.target.matches(".qty")) updateTotals();
});
</script>

</body>
</html>





